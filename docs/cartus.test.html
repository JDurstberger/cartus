<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>cartus.test documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Cartus</span> <span class="project-version">0.1.14</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Topics</span></h3><ul><li class="depth-1 "><a href="getting-started.html"><div class="inner"><span>Getting Started</span></div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>cartus</span></div></div></li><li class="depth-2 branch"><a href="cartus.cambium.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>cambium</span></div></a></li><li class="depth-2 branch"><a href="cartus.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2 branch"><a href="cartus.null.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>null</span></div></a></li><li class="depth-2 current"><a href="cartus.test.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>test</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="cartus.test.html#var-events"><div class="inner"><span>events</span></div></a></li><li class="depth-1"><a href="cartus.test.html#var-logged.3F"><div class="inner"><span>logged?</span></div></a></li><li class="depth-1"><a href="cartus.test.html#var-logger"><div class="inner"><span>logger</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">cartus.test</h1><div class="doc"><div class="markdown"><p>A <a href="cartus.core.html#var-Logger">cartus.core/Logger</a> implementation and utilities for use in tests.</p></div></div><div class="public anchor" id="var-events"><h3>events</h3><div class="usage"><code>(events test-logger)</code></div><div class="doc"><div class="markdown"><p>Retrieves events logged to the provided <code>test-logger</code>.</p></div></div><div class="src-link"><a href="https://github.com/logicblocks/cartus/blob/0.1.14/test/src/cartus/test.clj#L34">view source</a></div></div><div class="public anchor" id="var-logged.3F"><h3>logged?</h3><div class="usage"><code>(logged? logger &amp; log-specs)</code><code>(logged? logger modifiers &amp; log-specs)</code></div><div class="doc"><div class="markdown"><p>Asserts that the logger received log events matching the provided log specs.</p>
<p>Takes either a logger and a variable number of log specs or a logger, a set of modifiers and a variable number of log specs:</p>
<ul>
  <li><code>logger</code> must be a <a href="cartus.test.html#var-logger">cartus.test/logger</a></li>
  <li><code>modifiers</code> must be a set, optionally containing one of each of:
    <ul>
      <li><code>#{:in-order :in-any-order}</code> to specify ordering constraints, defaults  to <code>:in-order</code></li>
      <li><code>#{:only :at-least}</code> to specify whether the provided logs must exactly  match the log events logged to the logger or whether they represent  a subset, defaults to <code>:at-least</code></li>
      <li><code>#{:fuzzy-contents :strict-contents}</code> to specify whether log events  should be matched fuzzily, i.e., surplus keys can be present in the  log event map, or strictly, i.e., the keys and values must match  exactly, defaults to <code>:fuzzy-contents</code></li>
    </ul>
  </li>
  <li>each log spec is a partial or full map of the log event as returned by <a href="cartus.test.html#var-events">events</a>.</li>
</ul>
<p>Internally, <code>logged?</code> uses the <code>matcher-combinators</code> library meaning more complex log specs can be provided, including using predicates to match parts of the log events. See the <a href="https://logicblocks.github.io/cartus/getting-started.html">Getting Started</a> guide for more details.</p>
<p>Examples:</p>
<pre><code>(is (logged? logger
  {:level   :debug
   :type    :service.database/connection-pool.started
   :context {:max-connections 10}}))
</code></pre>
<pre><code>(is (logged? logger #{:in-any-order :strict-contents}
  {:level   :info
   :type    :service.database/connection-pool.online.starting
   :context {:max-connections 10}
   :meta    {:ns     (find-ns 'service.database)
             :line   1
             :column 1}}
   {:level   :info
   :type    :service.database/connection-pool.batch.starting
   :context {:max-connections 3}
   :meta    {:ns     (find-ns 'service.database)
             :line   2
             :column 1}}))
</code></pre></div></div><div class="src-link"><a href="https://github.com/logicblocks/cartus/blob/0.1.14/test/src/cartus/test.clj#L39">view source</a></div></div><div class="public anchor" id="var-logger"><h3>logger</h3><div class="usage"><code>(logger)</code></div><div class="doc"><div class="markdown"><p>Constructs a test logger storing all logged events in an atom.</p>
<p>Events are stored as maps including all provided attributes, in the order in which they occur, accounting for concurrency.</p>
<p>Events can be retrieved using <a href="cartus.test.html#var-events">events</a>.</p></div></div><div class="src-link"><a href="https://github.com/logicblocks/cartus/blob/0.1.14/test/src/cartus/test.clj#L24">view source</a></div></div></div></body></html>